# Building a calculator (part 2)

What you built earlier was easy; we assumed the user is sensible and doesn't make any mistakes. Unfortunately, users are usually idiots who can't seem to be sensible.  They break our app in the most magnificent ways.

To make our app robust, we have to consider edge cases, and we'll be doing so in this lesson.

Once again, when a user picks up a calculator, they can hit a few keys:

1. They hit a number key (0-9)
2. They hit an operator key (+, -, &times;, √∑)
3. They hit the decimal key
4. They hit the equal key
5. They hit the clear key

If you want to build your app to withstand any edge cases, you have to begin by being nasty. You have to imagine the user hitting the wrong keys in the wrong sequence.

Since the correct key to hit at the start of a calculation is a number, you have to understand and build for what happens if the bugger hits any other key.

This time, instead of focusing on the best possible path, I'll focus on when each key can go horribly wrong, and what you should build into your calculator to make it right.

For this exercise, let's say our user is Tim.

## What happens if Tim hits a decimal key?

Right off the bat, when the display says 0, Tim can hit a decimal key. If he does so, they display should read `0.`.

<figure>
  <img src="../../images/components/calculator/edge/decimal-first.gif" alt="">
  <figcaption></figcaption>
</figure>

If the display already has a decimal key, and Tim still hits the decimal key (damn him!), nothing should happen. Make sure that nothing happens even if decimal numbers have been keyed in.

<figure>
  <img src="../../images/components/calculator/edge/decimal-multiple.gif" alt="">
  <figcaption></figcaption>
</figure>

<figure>
  <img src="../../images/components/calculator/edge/decimal-multiple-2.gif" alt="">
  <figcaption></figcaption>
</figure>

After a hitting an operator key, Tim may hit the decimal key right away. If it happens, the display should be replaced by `0.`.

<figure>
  <img src="../../images/components/calculator/edge/decimal-after-operator.gif" alt="">
  <figcaption></figcaption>
</figure>

## What happens when Tim hits an operator key?

Tim may hit the operator key right at the start of a calculation. If he does so, the operator should light up. Nothing else should happen.

<figure>
  <img src="../../images/components/calculator/edge/operator-first.gif" alt="">
  <figcaption></figcaption>
</figure>

Tim may also hit the same operator key multiple times to ensure that it is actually selected (I've seen many people do this, don't be alarmed!). If Tim does this, the operator key should remain depressed.

<figure>
  <img src="../../images/components/calculator/edge/operator-multiple.gif" alt="">
  <figcaption></figcaption>
</figure>

Tim may also hit another operator key because he made a mistake. When this happens, original operator key should no longer be in a depressed state. The new operator key should be depressed.

<figure>
  <img src="../../images/components/calculator/edge/operator-switch.gif" alt="">
  <figcaption></figcaption>
</figure>

After entering a number, an operator, and another number, Tim may hit a operator key again. When this happens, the displayed number should be updated to the correct calculated value.

<figure>
  <img src="../../images/components/calculator/edge/operator-calc.gif" alt="">
  <figcaption></figcaption>
</figure>

### What happens if Tim hits the equal key?

Tim can hit the equal key right at the start of the calculation. If Tim does this, nothing should happen. The displayed value should still remain at zero.

<figure>
  <img src="../../images/components/calculator/edge/equal-first.gif" alt="">
  <figcaption></figcaption>
</figure>

Tim can hit a number (or decimal), followed by the equal key. If Tim does this, the number reflected on the display should remain as the same as before.

<figure>
  <img src="../../images/components/calculator/edge/equal-after-num.gif" alt="">
  <figcaption></figcaption>
</figure>

Tim can hit a number, followed by an operator, followed by a equal. When Tim does this, the calculator should calculate the result based on the operator, in this way:

1. `2 + =` ‚Äî> 2 + 2
2. `2 - =` ‚Äî> 2 - 2
3. `2 &times; =` ‚Äî> 2 * 2
4. `2 √∑ =` ‚Äî> 2 √∑ 2

<figure>
  <img src="../../images/components/calculator/edge/num-op-equal.gif" alt="">
  <figcaption></figcaption>
</figure>

After a calculation is completed, Tim can hit the equal key again. If Tim does so, the calculator should update the display with a new calculation. This new calculation should be made with the previous calculation, with the currently displayed number as an input.

<figure>
  <img src="../../images/components/calculator/edge/equal-consec-calc.gif" alt="">
  <figcaption></figcaption>
</figure>

If a calculation is completed, and Tim hits an operator key, followed by a number, followed by the equal key, the calculator should calculate normally, with the displayed number as the first value of the equation.

<figure>
  <img src="../../images/components/calculator/edge/calc-op-calc.gif" alt="">
  <figcaption></figcaption>
</figure>

## What happens if Tim hits the clear key?

The clear key has two uses:

1. All Clear (denoted by `AC`). It clears everything and resets the calculator to its initial state.
2. Clear entry (denoted by `CE`). It clears the currenty entry and keeps previous numbers in memory.

When the calculator is in its default state, `AC` should be shown.

<figure>
  <img src="../../images/components/calculator/edge/default.png" alt="">
  <figcaption></figcaption>
</figure>

When Tim hits a key (any key except clear), `AC` should be changed to `CE`.

<figure>
  <img src="../../images/components/calculator/edge/decimal-first.gif" alt="">
  <figcaption></figcaption>
</figure>

If Tim hits `CE`, `AC` should now show, allowing Tim to hit `AC` to reset the calculator to its initial state.

<figure>
   <img src="../../images/components/calculator/edge/clear.gif" alt="">
   <figcaption></figcaption>
 </figure>

If a number has been calculated, and Tim hits an operator, followed by clear, the displayed number should show 0. At this point, if Tim hits a number, followed by equal, the calculator should calculate a result based on the previously calculated number, and the displayed number.

(Yeah, it can get pretty complicated; let's stop here.)

<figure>
  <img src="../../images/components/calculator/edge/calc-op-clear.gif" alt="">
  <figcaption></figcaption>
</figure>

If Tim hits clear while `AC` is shown, all values should be cleared and reset to its initial state.

## Try building this

Okay, you try building the calculator üòÅ. I'll show you how to build the calculator in the next lesson.
